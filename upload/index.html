<html><head><script src="./jquery.min.js" type="text/javascript"></script>
<script>
    var wsocket = new WebSocket("ws://161.246.6.225:8080/ws");
    
    wsocket.onopen = function(){  
        console.log("connected"); 
    }; 
 
    wsocket.onmessage = function (message) {
        console.log("receiving: " + message.data);
        if(message.data.substring(0,4) == "/ldr") {

        } else if(message.data == "2") {
            $("#led_stat").text("LED STATUS : OFF");
        }else{
            LDR_value = Math.floor(parseInt(message.data)/1023*100);
            getAmbient();
        }
    };
 
    wsocket.onclose = function(){
        console.log("disconnected"); 
    };
 
    sendMsg = function(message) {
        wsocket.send(message);
    };
</script>

</head><body onload="onCreate()">


<div class="container navbar-inverse">
        <div class="navbar-header " align="right">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Shrimp Farm Assistant</a>
        </div>
        
        <div class="navbar-right">
            <span id="date_time" style="font-size: 16px;" class="navbar-collapse">Thursday July 31 2014 16:40:50</span>    

        </div>
</div>
<br><br><br>
<div class="row">
    <div class="col-md-3 col-sm-3 col-xs-3"></div>
    <div class="col-md-3 col-sm-3 col-xs-3">    
        <div class="center">
            <span id="ambientValue" class="alert alert-success">Ambient  :NaN</span>
            
        </div>
    </div>
    <br><br>
    <!--div class="col-md-6 col-sm-3 col-xs-3">    
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<canvas id="chart" width="400" height="100"></canvas>
    </div-->
</div>
<div class="row">
    <div class="col-md-3 col-sm-3 col-xs-3"></div>
    <div class="col-md-6 col-sm-6 col-xs-6"> 
        <canvas id="chart" width="400" height="100"></canvas>   
    </div>
    <br><br>
    <div class="col-md-3 col-sm-3 col-xs-3">    
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </div>
</div>

<br>
<div class="row">
    <div class="col-md-6 col-sm-6 col-xs-6"> 
        <h3 id="led_stat1" class="right">MOTOR1 STATUS : ON</h3>
        <br><br><br><br>
        <h3 id="led_stat2" class="right">MOTOR2 STATUS : ON</h3>
        <br><br><br><br>
        <h3 id="led_stat3" class="right">MOTOR3 STATUS : ON</h3>
        <br><br><br>
    </div>   
    <div class="col-md-1 col-sm-1"> 

        <input type="submit" id="sw1" value="ON" onclick="swClick('sw1')" class="alert alert-success">
        <input type="submit" id="sw2" value="ON" onclick="swClick('sw2')" class="alert alert-success">
        <input type="submit" id="sw3" value="ON" onclick="swClick('sw3')" class="alert alert-success">
    </div>
</div>
<br><br><br>
<div class="row">
    <div class="col-md-4 col-sm-4 col-xs-4"></div>
    <div class="col-md-2 col-sm-2 col-xs-2">
    <input type="time" id="myTime" value="00:00:00" required="true" size="4">

    <p>time</p>



    <br><br>
    <input type="number" id="myQuantity" value="0" max="50" min="0" required="true" size="4" maxlength="2">
    <p>Quantity(kg)</p>


    </div>
    <div class="col-md-2 col-sm-2 col-xs-2">
        <input type="submit" id="ADD" value="ADD" onclick="addClick()" class="alert alert-success">
    </div>
</div>
<div class="row">
  <div class="col-md-2 col-sm-2 col-xs-2"></div>

  <div class="panel panel-default col-md-8 col-sm-8 col-xs-8">
  <!-- Default panel contents -->
  <div class="panel-heading">Panel heading</div>

  <!-- Table -->
    ...
  <table class="table"></table>
  </div>
  <div class="col-md-2 col-sm-2 col-xs-2"></div>
</div>

<script>
    function onCreate(){
        date_time('date_time');

        createTimeline();
        getAmbient();
       // createTimeline();
        
    }
</script>
<script type="text/javascript" src="smoothie.js"></script>
<script type="text/javascript">

      // Randomly add a data point every 500ms
    var random = new TimeSeries();
    setInterval(function() {
        random.append(new Date().getTime(), LDR_value * 500);
        }, 500);
      
    function createTimeline() {
        var chart = new SmoothieChart();
        chart.addTimeSeries(random, { strokeStyle: 'rgba(0, 255, 0, 1)', fillStyle: 'rgba(0, 255, 0, 0.2)', lineWidth: 4 });
        chart.streamTo(document.getElementById("chart"), 500);
    }
</script>
    
<script type="text/javascript">

    function addClick(){
        var time = document.getElementById('myTime').value+"";
        var vartime = time.substring(0,2)+time.substring(3,5); 
        var quantity = document.getElementById('myQuantity').value;
        sendMsg("/f"+vartime+quantity);

    }
    function date_time(id)
    {
        date = new Date;
        year = date.getFullYear();
        month = date.getMonth();
        months = new Array('January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December');
        d = date.getDate();
        day = date.getDay();
        days = new Array('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday');
        h = date.getHours();
        if(h<10)
        {
                h = "0"+h;
        }
        m = date.getMinutes();
        if(m<10)
        {
                m = "0"+m;
        }
        s = date.getSeconds();
        if(s<10)
        {
                s = "0"+s;
        }
        result = ''+days[day]+' '+months[month]+' '+d+' '+year+' '+h+':'+m+':'+s;
        document.getElementById(id).innerHTML = result;
        document.getElementById(id).verticalAlign="top";
        setTimeout('date_time("'+id+'");','1000');
        return true;
    }

    </script>
    
    <script>
    var LDR_value=1;
    function getAmbient()
    {
        //var ambient = 100;
        var id = document.getElementById('ambientValue');
        if (LDR_value <= 30) {
            id.className = "alert alert-danger";
            var motor1ID = document.getElementById('led_stat1');
            var buttonID = document.getElementById('sw1');
            if(buttonID.className ="alert alert-danger"){
                buttonID.className = "alert alert-success";
                buttonID.value = 'ON';
                motor1ID.innerHTML = 'MOTOR1'+' STATUS : '+'ON';
            }
        }
        else if (LDR_value <= 60) {
            id.className = "alert alert-warning";
        }
        else{
            id.className = "alert alert-success";
        }
        id.innerHTML = "Ambient  :" + LDR_value;
    }

    function swClick(id){
        var thisID = document.getElementById(id);
        var thisValue = document.getElementById('led_stat'+id.substring(2));
        if(thisID.className == "alert alert-success"){
            thisID.className = "alert alert-danger";
            thisID.value = 'OFF';
            thisValue.innerHTML = 'MOTOR'+id.substring(2)+' STATUS : '+'OFF';
            sendMsg(id+'c');
        }
        else if(thisID.className == "alert alert-danger"){
            thisID.className = "alert alert-success";
            thisID.value = 'ON';
            thisValue.innerHTML = 'MOTOR'+id.substring(2)+' STATUS : '+'ON';
            sendMsg(id+'o');

        }

    }
    function timeBox() {
        var x = document.getElementById("myTime").value;
        document.getElementById("demo").innerHTML = x;
    }

    
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
    </script>
    <script src="js/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet">


<style>
    #sw1,#sw2 {
        
    } 
    

    .center {
        position: fixed;
        left: 50%;
        
        margin-left: -100px;
    }
    .right {
        position: absolute;
        right: 0px;
        width: 300px;
        
    }

    #circle {
        width: 50px;
        height: 50px;
        -webkit-border-radius: 25px;
        -moz-border-radius: 25px;
        border-radius: 25px; 
    }
</style>
</body></html>